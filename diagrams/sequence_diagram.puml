@startuml SequenceDiagram
' Online Order Placement Sequence Diagram
skinparam defaultFontName "Arial"
skinparam defaultFontSize 14
skinparam dpi 150
skinparam shadowing false
skinparam lifelineStrategy solid
skinparam Participant {
  BackgroundColor #FEF5E7
  BorderColor #6F4E37
  BorderThickness 1
}

participant Customer
participant "Web UI" as WebUI
participant "App Controller" as App
database "MySQL\nDatabase" as DB
participant "Payment Gateway" as Payment
participant "Notification Service" as Notify
participant "Admin Dashboard" as AdminPanel

Customer -> WebUI : browseMenu()
WebUI -> App : loadMenu()
App -> DB : SELECT products
DB --> App : productList
App --> WebUI : renderMenu(productList)

Customer -> WebUI : addItem(productId, qty)
WebUI -> App : updateCart(productId, qty)
App -> DB : UPSERT cart_item
DB --> App : cartSnapshot
App --> WebUI : displayCart(cartSnapshot)

Customer -> WebUI : checkout(credentials, pickupDetails)
WebUI -> App : initiateCheckout(payload)
App -> DB : SELECT user BY email
DB --> App : userRecord
App -> DB : SELECT cart items
DB --> App : cartLines
App -> DB : SELECT inventory for products
DB --> App : availabilityStatus
App --> WebUI : presentOrderReview(cartLines, totals)

Customer -> WebUI : confirmOrder(paymentToken)
WebUI -> App : finalizeOrder(paymentToken)
App -> DB : INSERT order + items
DB --> App : orderId
App -> Payment : authorize(orderId, amount, token)
activate Payment
Payment --> App : authorizationResult
deactivate Payment

alt payment approved
  App -> DB : UPDATE order SET status='Processed'
  App -> DB : INSERT transaction record
  App -> Notify : pushReceipt(orderId, amount)
  Notify --> Customer : confirmationMessage
  Notify --> AdminPanel : newOrderAlert
  App --> WebUI : showSuccess(orderId)
else payment declined
  App -> DB : UPDATE order SET status='Pending Payment'
  App --> WebUI : showPaymentError()
end

Customer --> WebUI : viewOrderStatus()
WebUI -> App : getOrderStatus(orderId)
App -> DB : SELECT status FROM orders
DB --> App : status
App --> WebUI : displayStatus(status)

@enduml
